<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Preview Companies</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.5/font/bootstrap-icons.min.css"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <!-- <style>
        /* .company-list {
            display: grid;
            gap: 10px;
        } */

        /* .company {
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 20px;
            position: relative;
        } */

        /* .company img {
            height: auto;
            margin-right: 15px;
            object-fit: contain;
        } */

        /* .company .title {
            font-size: 1.35rem;
            color: rgb(32, 52, 111);
            font-weight: bold;
            margin: 0;
        } */

        /* .company-content {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .technologies {
            margin-top: 10px;
            margin-left: 30px;
        } */

        /* .col-md-12 img {
            width: 300px !important ;
        }

        .col-md-6 img {
            width: 250px !important;
        } */
    </style> -->
    <style>
        /* #companyList .company:hover, */
        #companiesSection .company:hover {
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
            transform: translateY(-2px);
            transition: all 0.3s ease;
        }
    </style>
</head>

<body>


    <div class="container">
        <div class="row header" style="display: flex; align-items: center; justify-content: space-between;">
            <div class="hTxt" id="previewHeader" style="flex-grow: 1; text-align: center;">
                <!-- UPCOMING DRIVES FOR SEPTEMBER & OCTOBER - 2024 -->
            </div>
            <div>
                <img src="./images/carrerit.png" alt="logo" width="150px" height="60px" class="hdr-sty">
            </div>
        </div>


        <!-- Company List -->
        <!-- <div class="company-list" id="companyList"> -->
        <!-- Company List will be inserted here -->
        <!-- </div> -->

        <div id="companiesSection" class="companies row">
            <!-- Dynamic companies will be inserted here after submission -->
        </div>
    </div>
    <!-- Footer -->
    <div class="footer row">
        <div class="col-4">
            <p style="text-align: left;">
                <i class="bi bi-telephone green-icon"></i>
                Kondalarao Arigela: <a href="tel:+919160040789" class="call-link">+91 9160040789</a>
            </p>
            <p style="text-align: left;">
                <i class="bi bi-telephone green-icon"></i>
                Venkat Genikala: <a href="tel:+919160096789" class="call-link">+91 9160096789</a>
            </p>
        </div>
        <div class="col-2">
            <img src="./images/qrcode_location.png" alt="QRcode" width="100px" height="90px">
        </div>
        <div class="col-5">
            <p style="text-align: left;"><i class="bi bi-geo-alt-fill white-icon"></i> Address: HIG 205, 4th & 5th
                Floor, Roots Academy Building,
                MRO Office Line, KPHB-Hyd.</p>
            <div class="row">
                <p class="col-6" style="text-align: left;">
                    <i class="bi bi-envelope-fill white-icon"></i>
                    Email: <a href="mailto:info@careerit.co.in" class="email-link">info@careerit.co.in</a>
                </p>
                <p class="col-6" style="text-align: left;">
                    <i class="bi bi-globe white-icon"></i>
                    <a href="https://www.careerit.co.in" class="website-link" target="_blank">www.careerit.co.in</a>
                </p>
            </div>

        </div>
    </div>


    <!-- Back Button -->
    <div class="row">
        <div class="col-12 d-flex justify-content-center m-3">
            <button class="btn btn-primary" id="backBtn">Back to Form</button>
        </div>
    </div>

    <script>
        // Back Button functionality to close preview and return to form
        document.getElementById('backBtn').addEventListener('click', function () {
            window.close(); // Close the preview window
        });

        window.addEventListener('message', function (event) {
            if (event.data.type === 'populatePreview') {
                const { headerTitle, companies } = event.data;



                // Debugging output
                console.log('Received Header Title:', headerTitle);
                console.log('Received Companies:', companies);


                // Set header title
                document.getElementById('previewHeader').innerText = '';
                document.getElementById('previewHeader').innerText = headerTitle;

                // Populate company list
                //const companyList = document.getElementById('companyList');
                const companiesSection = document.getElementById('companiesSection');
                // companyList.innerHTML = ''; // Clear previous list
                companiesSection.innerHTML = ''; // Clear previous list

                // Group companies into rows
                const rows = groupCompaniesIntoRows(companies.length);
                let currentIndex = 0;

                rows.forEach(rowCount => {
                    // Create a new row
                    const row = document.createElement('div');
                    row.classList.add('row', 'mb-4'); // Add margin-bottom for spacing between rows

                    for (let i = 0; i < rowCount; i++) {
                        if (currentIndex >= companies.length) break; // Prevent overflow

                        const company = companies[currentIndex];
                        let colSize;
                        let imgStyle;

                        // Determine the column size and image style based on number of companies
                        if (rowCount >= 4 || companies.length > 12) {
                            // If 4 companies or more in the row, reduce size dynamically
                            colSize = 'col-md-3'; // Each company takes 25% width
                            imgStyle = 'style="width:120px;height:auto;"'; // Smaller image
                        } else {
                            switch (rowCount) {
                                case 1:
                                    colSize = 'col-md-12';
                                    imgStyle = 'style="width:180px;height:auto;"';
                                    break;
                                case 2:
                                    colSize = 'col-md-6';
                                    imgStyle = 'style="width:180px;height:auto;"';
                                    break;
                                case 3:
                                    colSize = 'col-md-4';
                                    imgStyle = 'style="width:180px;height:auto;"';
                                    break;
                            }
                        }

                        const companyElement = document.createElement('div');

                        companyElement.classList.add(colSize, 'mb-3', 'company-item', 'sty12');

                        // Center the company if it's the only one in the row
                        if (rowCount === 1) {
                            companyElement.classList.add('mx-auto'); // Center horizontally
                        }

                        companyElement.innerHTML = `
                    <div class="company">
                        <div class="company-content">
                        ${companies.length <= 2 ? `<img src="${company.logo}" alt="${company.name}" class="img-fluid company-logo"  style="width:180px;height:auto;" onerror="this.onerror=null; this.src='default-image.png';">
                         `: `<img src="${company.logo}" alt="${company.name}" ${imgStyle} class="img-fluid company-logo" onerror="this.onerror=null; this.src='default-image.png';">
                        `}
                        <p class="title" style='margin-left:10px;'>${company.name}</p>
                        </div>
                        ${company.technologies ? `
                        <div class="technologies">
                            <p><strong>Technologies:</strong> ${company.technologies}</p>
                        </div>` : ''}
                    </div>
                `;
                        row.appendChild(companyElement);
                        currentIndex++;
                    }

                    // Center the row if it's not full
                    if (rowCount < 4) {
                        row.classList.add('justify-content-center');
                    }

                    // companyList.appendChild(row);
                    companiesSection.appendChild(row);
                });

            }
        });

        // Function to group companies into rows based on total number
        function groupCompaniesIntoRows(total) {
            const rows = [];
            let remaining = total;

            while (remaining > 0) {
                if (remaining === 12) {
                    rows.push(4, 4, 4); // 12 companies: 3 rows of 4
                    remaining -= 12;
                } else if (remaining === 11) {
                    rows.push(4, 4, 3); // 11 companies: 2 rows of 4, 1 row of 3
                    remaining -= 11;
                } else if (remaining === 10) {
                    rows.push(4, 4, 2); // 10 companies: 2 rows of 4, 1 row of 2
                    remaining -= 10;
                } else if (remaining === 9) {
                    rows.push(3, 3, 3); // 9 companies: 3 rows of 3
                    remaining -= 9;
                } else if (remaining === 8) {
                    // rows.push(4, 4); // 8 companies: 2 rows of 4
                    rows.push(3, 3, 2); // 8 companies: 3 rows of 3,3,2
                    remaining -= 8;
                } else if (remaining === 7) {
                    // rows.push(4, 3); // 7 companies: 1 row of 4, 1 row of 3
                    rows.push(3, 2, 2); // 7 companies: 1 row of 4, 1 row of 3
                    remaining -= 7;
                } else if (remaining === 6) {
                    // rows.push(3, 3); // 6 companies: 2 rows of 3
                    rows.push(2, 2, 2); // 6 companies: 2 rows of 3
                    remaining -= 6;
                } else if (remaining === 5) {
                    // rows.push(3, 2); // 5 companies: 1 row of 3, 1 row of 2
                    rows.push(2, 1, 2); // 5 companies: 1 row of 3, 1 row of 2
                    remaining -= 5;
                } else if (remaining === 4) {
                    rows.push(2, 2); // 4 companies: 2 rows of 2
                    remaining -= 4;
                } else if (remaining === 3) {
                    rows.push(2, 1); // 3 companies: 1 row of 2, 1 row of 1
                    remaining -= 3;
                } else if (remaining === 2) {
                    // rows.push(2); // 2 companies: 1 row of 2
                    rows.push(1, 1);
                    remaining -= 2;
                } else if (remaining === 1) {
                    rows.push(1); // 1 company: 1 row of 1
                    remaining -= 1;
                } else {
                    // Handle cases with more than 12 companies
                    rows.push(4); // 4 companies per row for more than 12 companies
                    remaining -= 4;
                }
            }

            return rows;
        }



        // processing rearrangement logic 

    </script>
</body>

</html>